<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Uri-Lex</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  *{box-sizing:border-box;}
  body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background:linear-gradient(135deg,#000,#111);
    color:white;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    overflow:hidden;
  }
  #splash{
    position:fixed;inset:0;
    display:flex;justify-content:center;align-items:center;
    font-size:3rem;font-weight:700;
    background:black;z-index:1000;
    animation:fadeSplash 3s ease forwards;
  }
  #splash span.u{
    background:white;color:black;padding:10px 14px;border-radius:10px;margin-right:8px;
  }
  @keyframes fadeSplash{
    0%{opacity:1;}90%{opacity:1;}100%{opacity:0;visibility:hidden;}
  }
  #app{
    display:none;
    flex-direction:column;
    width:100%;
    height:100vh;
    padding:20px;
  }
  #header{
    font-weight:700;
    font-size:1.2rem;
    text-align:center;
    margin-bottom:20px;
  }
  #askSection{
    margin-top:auto;
    display:flex;
    flex-direction:column;
    align-items:center;
  }
  #askBox{
    position:relative;
    width:100%;
    max-width:600px;
  }
  #userInput{
    width:100%;
    background:#111;
    color:white;
    border:none;
    border-radius:40px;
    padding:14px 50px 14px 18px;
    font-size:1rem;
    outline:none;
  }
  #sendBtn{
    position:absolute;
    right:10px;
    top:50%;
    transform:translateY(-50%);
    background:#0078ff;
    border:none;
    border-radius:50%;
    width:40px;
    height:40px;
    display:flex;
    justify-content:center;
    align-items:center;
    cursor:pointer;
  }
  #sendBtn img{width:20px;height:20px;filter:invert(1);}
  #chatArea{
    display:none;
    flex-direction:column;
    height:100%;
  }
  #chatBox{
    flex:1;
    overflow-y:auto;
    padding-bottom:10px;
  }
  .msg{margin:10px 0;padding:12px;border-radius:12px;line-height:1.5;}
  .user{background:#1a1a1a;align-self:flex-end;}
  .ai{background:#0b0b0b;border-left:3px solid #0078ff;}
  a{color:#4aa3ff;font-weight:bold;text-decoration:underline;}
  #reAskBtn{
    background:#111;border:2px solid #0078ff;color:#fff;
    padding:10px 16px;border-radius:30px;font-weight:600;
    width:max-content;margin:15px auto;cursor:pointer;
  }
  #history{
    display:flex;flex-direction:column;gap:10px;
    max-height:50vh;overflow-y:auto;width:100%;
  }
  .historyItem{
    background:#111;padding:10px 14px;border-radius:12px;
    font-size:0.95rem;cursor:pointer;transition:0.3s;
  }
  .historyItem:hover{background:#1a1a1a;}
</style>
</head>
<body>

<div id="splash"><span class="u">U</span><span>ri-Lex</span></div>

<div id="app">
  <div id="header">Ask, Search, Anything — Your Uri-Lex</div>

  <div id="history"></div>

  <div id="chatArea">
    <div id="chatBox"></div>
    <div id="reAskBtn" onclick="resetToAsk()">Re-Ask</div>
  </div>

  <div id="askSection">
    <div id="askBox">
      <input type="text" id="userInput" placeholder="Ask something..." />
      <button id="sendBtn"><img src="https://cdn-icons-png.flaticon.com/512/786/786205.png"></button>
    </div>
  </div>
</div>

<script>
const apiKey="AIzaSyD4nLeImTfLbnNhcFUIDHhwU2FC7gVkTyo";
const splash=document.getElementById('splash');
const app=document.getElementById('app');
const input=document.getElementById('userInput');
const sendBtn=document.getElementById('sendBtn');
const chatArea=document.getElementById('chatArea');
const chatBox=document.getElementById('chatBox');
const historyBox=document.getElementById('history');

window.addEventListener('load',()=>{setTimeout(()=>{splash.style.display='none';app.style.display='flex';loadHistory();},3000);});

function resetToAsk(){
  chatArea.style.display='none';
  document.getElementById('askSection').style.display='flex';
  loadHistory();
}

function loadHistory(){
  historyBox.innerHTML='';
  const history=JSON.parse(localStorage.getItem('urilex_history')||'[]');
  if(history.length===0){
    const p=document.createElement('p');
    p.textContent="Your previous asks will appear here.";
    p.style.color="#888";
    p.style.textAlign="center";
    historyBox.appendChild(p);
  }else{
    history.forEach(q=>{
      const div=document.createElement('div');
      div.classList.add('historyItem');
      div.textContent=q;
      div.onclick=()=>{input.value=q;sendMsg();};
      historyBox.appendChild(div);
    });
  }
}

async function sendMsg(){
  const text=input.value.trim();
  if(!text)return;
  saveHistory(text);
  document.getElementById('askSection').style.display='none';
  historyBox.innerHTML='';
  chatArea.style.display='flex';
  chatBox.innerHTML='';

  const userDiv=document.createElement('div');
  userDiv.className='msg user';
  userDiv.textContent=text;
  chatBox.appendChild(userDiv);

  const aiDiv=document.createElement('div');
  aiDiv.className='msg ai';
  aiDiv.textContent='Uri-Lex is thinking...';
  chatBox.appendChild(aiDiv);

  const prompt=`Hey Gemini, act as Google, not as AI. Reply informatively like Google results, with helpful links in plain text (no ** or *). The user's message: "${text}"`;
  try{
    const res=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key="+apiKey,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({contents:[{parts:[{text:prompt}]}]})
    });
    const data=await res.json();
    let reply=data.candidates?.[0]?.content?.parts?.[0]?.text || "Uri-Lex couldn’t fetch results right now.";
    reply=reply.replace(/\*\*/g,"").replace(/\*/g,"");
    reply=reply.replace(/(https?:\/\/[^\s]+)/g,'<a href="$1" target="_blank">$1</a>');
    aiDiv.innerHTML=reply;
    chatBox.scrollTop=chatBox.scrollHeight;
  }catch(e){
    aiDiv.textContent="Uri-Lex ran into a technical issue. Please try again.";
  }
  input.value='';
}

function saveHistory(q){
  let h=JSON.parse(localStorage.getItem('urilex_history')||'[]');
  h.unshift(q);
  if(h.length>10)h=h.slice(0,10);
  localStorage.setItem('urilex_history',JSON.stringify(h));
}

sendBtn.onclick=sendMsg;
input.addEventListener('keypress',e=>{if(e.key==='Enter')sendMsg();});
</script>
</body>
</html>
